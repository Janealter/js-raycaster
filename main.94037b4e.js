parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"b1gF":[function(require,module,exports) {
module.exports=[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,1,1,1,1,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,1,1,1,0,0,0,0,0,0,1,1,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]];
},{}],"rvka":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MAX_BLOCKS=exports.MAP_PIXELS=exports.render3DView=exports.renderLine=exports.renderPlayer=exports.renderMap=void 0;var e=512;exports.MAP_PIXELS=e;var r=16;exports.MAX_BLOCKS=r;var t="#e22b2b",i=e/r;function n(e,n){for(var o=new Array(2*r).fill(void 0),l=0;l<n.length;l++)for(var d=n[l],a=0;a<d.length;a++){if(d[a])x(e,{x:i*a,y:i*l,width:i,height:i,fill:t}),o[a+l*r]={x:a,y:l}}return o}function o(e,r){var t=r.x,n=r.y;x(e,{x:t*i-5,y:n*i-5,width:10,height:10,fill:"#000000"})}function l(r,i,n){x(r,{x:0,y:0,width:e,height:e,fill:"#dcdcdc"});for(var o=0;o<i.length;o++){var l=i[o],d=l.distance,h=l.angle,f=e/(d*Math.cos(h-n)),s=(e-f)/2;a(r,{x:o,y:s},{x:o,y:s+f},{fill:t})}}function x(e,r){var t=r.x,i=r.y,n=r.width,o=r.height,l=r.fill,x=void 0===l?"#ff0000":l,d=new Path2D;d.rect(t,i,n,o),e.fillStyle=x,e.fill(d)}function d(e,r,t,n){var o=r.x,l=r.y,x=t.x,d=t.y;a(e,{x:o*i,y:l*i},{x:x*i,y:d*i},n)}function a(e,r,t){var i=r.x,n=r.y,o=t.x,l=t.y,x=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},d=x.fill,a=void 0===d?"#000000":d,h=x.width,f=void 0===h?1:h,s=new Path2D;e.beginPath(),s.moveTo(i,n),s.lineTo(o,l),e.lineWidth=f,e.strokeStyle=a,e.stroke(s),e.beginPath()}exports.renderMap=n,exports.renderPlayer=o,exports.render3DView=l,exports.renderLine=d;
},{}],"iMXC":[function(require,module,exports) {
"use strict";function t(t,o){return Number("".concat(Math.round(Number("".concat(t,"e").concat(o))),"e-").concat(o))}function o(t){var o;return(null===(o=t.toString().split(".")[1])||void 0===o?void 0:o.length)||0}function e(){for(var t="#",o=0;o<6;o++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getRandomColor=exports.getFractionDigitsNumber=exports.exponentialRound=void 0,exports.exponentialRound=t,exports.getFractionDigitsNumber=o,exports.getRandomColor=e;
},{}],"wpgk":[function(require,module,exports) {
"use strict";function e(){var e=document.getElementById("map-canvas"),t=document.getElementById("rays-canvas"),n=document.getElementById("3d-view-canvas");if(!(e&&t&&n&&e instanceof HTMLCanvasElement&&t instanceof HTMLCanvasElement&&n instanceof HTMLCanvasElement))throw new Error("Canvas element not found");var a=e.getContext("2d"),o=t.getContext("2d"),r=n.getContext("2d");if(!a||!o||!r)throw new Error("Canvas context is on available");return{mapContext:a,raysContext:o,viewContext:r}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"ZCfc":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("./map.json")),t=require("./renderer"),n=require("./helpers"),o=e(require("./init")),a=r.default,i=Math.PI/3,u=.05,y=.2,s=6.2,d={x:2,y:2},f=0,l=o.default(),x=l.mapContext,c=l.raysContext,M=l.viewContext,h=t.renderMap(x,a);function w(){var e=p(c,f);t.renderPlayer(c,d),t.render3DView(M,e,f)}function p(e,r){var n=[];e.clearRect(0,0,t.MAP_PIXELS,t.MAP_PIXELS);for(var o=0;o<t.MAP_PIXELS;o++)for(var a=r-i/2+i*o/t.MAP_PIXELS,u=0;u<20;u+=.05){var y=d.x+u*Math.cos(a),s=d.y+u*Math.sin(a);if(v(h,{x:y,y:s})){t.renderLine(e,{x:d.x,y:d.y},{x:y,y:s},{fill:"gray",width:.5}),n.push({angle:a,distance:u});break}}return n}function v(e,r){var n=r.x,o=r.y;return e[Math.floor(n)+Math.floor(o)*t.MAX_BLOCKS]}w(),document.addEventListener("keydown",function(e){if(e.preventDefault(),["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e.key)){var r=0,t=0,o=0;"ArrowRight"===e.key&&(r=n.exponentialRound(f+u,n.getFractionDigitsNumber(u)),f=r>s?0:r),"ArrowLeft"===e.key&&(r=n.exponentialRound(f-u,n.getFractionDigitsNumber(u)),f=r<0?s:r),"ArrowUp"===e.key&&(t=d.x+y*Math.cos(f),o=d.y+y*Math.sin(f),v(h,{x:t,y:o})||(d.x=t,d.y=o)),"ArrowDown"===e.key&&(t=d.x-y*Math.cos(f),o=d.y-y*Math.sin(f),v(h,{x:t,y:o})||(d.x=t,d.y=o)),w()}});
},{"./map.json":"b1gF","./renderer":"rvka","./helpers":"iMXC","./init":"wpgk"}]},{},["ZCfc"], null)
//# sourceMappingURL=main.94037b4e.js.map